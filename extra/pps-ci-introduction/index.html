<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>DevOps in a nutshell</title>
<meta name="description" content="Make things work, keep them working, move fast">
<meta name="author" content="Danilo Pianini">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/reveal-js/css/reset.css">
<link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/reveal-js/css/reveal.css">
  <link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/css/custom-theme.min.0ab8c954a02adc8ff8cfc306d8ab3bd3463c057f69a5aaef066c5efaa444854e.css" id="theme"><link rel="stylesheet" href="/Course-Laboratory-of-Software-Systems/highlight-js/default.min.css">
    
<link rel="stylesheet" href="https://gitcdn.link/repo/DanySK/css-blur-animation/master/blur.css">
<link href='https://fonts.googleapis.com/css?family=Roboto Mono' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Oxygen Mono' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu Mono' rel='stylesheet'>

  </head>
  <body>
    
    <div class="reveal">
      <div class="slides">
  

    <section><h1 id="development-and-programming-paradigms">Development and programming paradigms</h1>
<h2 id="continuous-integration">Continuous Integration</h2>
<h3 id="danilo-pianinimailtodanilopianiniuniboit"><a href="mailto:danilo.pianini@unibo.it">Danilo Pianini</a></h3>
2021-10-20

</section>
<section data-noprocess data-shortcode-slide>
  <h1 id="development">Development</h1>
<ul>
<li>Analysis of a domain</li>
<li>Design of a solution</li>
<li>Implementation</li>
<li>Testing</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="operations">Operations</h1>
<ul>
<li>IT infrastructure</li>
<li>Deployment</li>
<li>Maintenance</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="silo-mentality">Silo mentality</h1>
<img src="../assets/silos.svg" onerror="this.onerror=null; this.src='../../assets/silos.svg'" style="max-height: 70vh; object-fit: contain;"/>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="no-silos"><strong>No</strong> silos</h1>
<img src="../assets/no-silos.svg" onerror="this.onerror=null; this.src='../../assets/no-silos.svg'" style="max-height: 70vh; object-fit: contain;"/>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="devops-culture">DevOps culture</h1>
<ul>
<li>
<p><strong>Increased collaboration</strong></p>
<ul>
<li>Dev and Ops should <em>exchange information</em> and <em>work together</em></li>
</ul>
</li>
<li>
<p><strong>Shared responsibility</strong></p>
<ul>
<li>A team is responsible for the (sub) product for its <em>whole lifetime</em></li>
<li><em>No handing over</em> projects from devs to ops</li>
</ul>
</li>
<li>
<p><strong>Autonomous teams</strong></p>
<ul>
<li><em>Lightweight decision making</em> process</li>
</ul>
</li>
<li>
<p><strong>Focus on the process, not just the product</strong></p>
<ul>
<li>Promote small, <em>incremental changes</em></li>
<li><em>Automate</em> as much as possible</li>
<li>Leverage the right <em>tool</em> for the job at hand</li>
</ul>
</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="why-bother">Why bother?</h1>
<ol>
<li>
<p><strong>Risk management</strong></p>
<ul>
<li>Reduce the probability of <em>failure</em></li>
<li>Detect <em>defects</em> before hitting the market</li>
<li>Quickly <em>react</em> to problems</li>
</ul>
</li>
<li>
<p><strong>Resource exploitation</strong></p>
<ul>
<li>Use <em>human resources</em> for human-y work</li>
<li>Reduce <em>time to market</em></li>
<li>Embrace <em>innovation</em></li>
<li>Exploit <em>emerging technologies</em></li>
</ul>
</li>
</ol>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="devops">DevOps</h1>
<ol>
<li><strong>Principles</strong></li>
<li><strong>Practices</strong></li>
<li><strong>Tools</strong></li>
</ol>
<p><strong>Principles</strong> <em>inspire</em> <strong>practices</strong></p>
<p><strong>Practices</strong> <em>require</em> <strong>tools</strong></p>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="devops-principles">DevOps principles</h1>
<h3 id="not-exhaustive">(not exhaustive)</h3>
<ul>
<li>Collaboration</li>
<li>Reproducibility</li>
<li>Automation</li>
<li>Incrementality</li>
<li>Robustness</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="devops-practices">DevOps practices</h1>
<ul>
<li>Workflow organization</li>
<li>Build automation</li>
<li>Self-testing code</li>
<li>Code quality control</li>
<li>Continuous Integration</li>
<li>Continuous Delivery</li>
<li>Continuous Deployment</li>
<li>Continuous Monitoring</li>
</ul>
</section><section>
<h1 id="worflow-organization">Worflow organization</h1>
<ul>
<li>Design a workflow that <strong>fits the team</strong>
<ul>
<li>Delicate balance between <em>chaotic organization</em> and <em>excessive bureaucracy</em></li>
<li>The larger the team, the more control is usually needed</li>
<li>Sparse teams and localized teams have different requisites</li>
</ul>
</li>
<li>Project progress is marked also by progress <strong>version control system</strong></li>
<li>Select a <em>branching model</em> model that matches the organization
<ul>
<li>possibly, a <em>forking model</em> for certain kinds of organization</li>
</ul>
</li>
<li><strong>Standardize</strong> the development environment
<ul>
<li>Which newlines on which kind of files?</li>
<li>What should be in tracking?</li>
</ul>
</li>
</ul>
</section><section>
<h1 id="version-control-systems">Version Control Systems</h1>
<p>A system responsible for managing changes to the project files</p>
<ul>
<li>Records the history</li>
<li>Enables roll-backs</li>
<li>Promotes collaborative workflows</li>
<li><strong>Distributed</strong> vs. <em>Centralized</em>
<ul>
<li><strong>Every developer has a whole copy of the entire history</strong></li>
<li><em>There exist a central point of synchronization</em></li>
</ul>
</li>
<li>Also called Source Content Management (SCM)</li>
</ul>
</section><section>
<h2 id="centralized-version-control-systems">Centralized Version Control Systems</h2>
<img src="2021-04-14-centralized-vcs.svg" style='
    
    
    max-width: 95vw;
    max-height: 65vh;
    object-fit: contain;
'>

</section><section>
<h2 id="decentralized-vcs">Decentralized VCS</h2>
<img src="2021-04-14-decentralized-vcs.svg" style='
    
    
    max-width: 95vw;
    max-height: 65vh;
    object-fit: contain;
'>

</section><section>
<h2 id="real-world-dvcs">Real-world DVCS</h2>
<img src="2021-04-14-dvcs-sink.svg" style='
    
    
    max-width: 95vw;
    max-height: 65vh;
    object-fit: contain;
'>

</section><section>
<h2 id="reference-dvcs-git">Reference DVCS: Git</h2>
<p>De-facto reference distributed version control system</p>
<ul>
<li><em>Distributed</em></li>
<li><em>Differential tracking</em></li>
<li>Born in <em>2005</em> to replace BitKeeper as SCM for the Linux kernel
<ul>
<li>Performance was a major concern</li>
<li>Written in C</li>
</ul>
</li>
<li>Developed by Linus Torvalds
<ul>
<li>Now maintained by Hamano and others</li>
</ul>
</li>
<li><em>Unix-oriented</em>
<ul>
<li>Tracks Unix file permissions</li>
</ul>
</li>
<li>Very <em>fast</em>
<ul>
<li>At conception, 10 times faster than Mercurial¹, 100 times faster than Bazaar</li>
</ul>
</li>
</ul>
<p>¹ Less difference now, Facebook vastly improved Mercurial</p>
</section><section>
<h2 id="funny-historical-introduction">Funny historical introduction</h2>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/4XpnKHJAok8?autoplay=1" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="Linus Torvalds introduces Git at Google"></iframe>
</div>

</section><section>
<h2 id="distributed-version-control-with-git-a-recap">Distributed version control with git: a recap</h2>
<p>You should already be acquainted with the tool, this is an express guide/recap</p>
<p>Sub-commands and files are in <code>monospace</code>, concepts in <em>italic</em></p>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-1">Distributed version control with git: a recap</h2>
<h3 id="repository"><em>Repository</em></h3>
<ul>
<li>Collection of metadata containing the history of the project</li>
<li>Reified in the <code>.git</code> folder</li>
<li>The location of the <code>.git</code> folder marks the root of the repository</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-2">Distributed version control with git: a recap</h2>
<h3 id="working-tree"><em>Working tree</em></h3>
<ul>
<li>The directory associated with the root of your repository and its contents</li>
<li>Contains the files tracked by git</li>
<li>Not all files in the working tree are tracked</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-3">Distributed version control with git: a recap</h2>
<h3 id="git-init"><code>git init</code></h3>
<ul>
<li>Initializes a new repository from the current directory</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-4">Distributed version control with git: a recap</h2>
<h3 id="stage"><em>Stage</em></h3>
<ul>
<li>The <strong>changes</strong> that will be saved next</li>
</ul>
<img src="staging.png" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>

</section><section>
<h2 id="distributed-version-control-with-git-a-recap-5">Distributed version control with git: a recap</h2>
<h3 id="git-add-files"><code>git add &lt;files&gt;</code></h3>
<ul>
<li>Moves the current <strong>changes</strong> in <code>&lt;files&gt;</code> into the <em>stage</em></li>
</ul>
<h3 id="git-reset-files"><code>git reset &lt;files&gt;</code></h3>
<ul>
<li>Removes the current <strong>changes</strong> to <code>&lt;files&gt;</code> from the <em>stage</em></li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-6">Distributed version control with git: a recap</h2>
<h3 id="gitignore"><code>.gitignore</code></h3>
<ul>
<li>A file listing the pathspecs that git should <strong>ignore</strong> even if added</li>
<li>Adding is still possible via <code>--force</code></li>
</ul>
<h3 id="gitattributes"><code>.gitattributes</code></h3>
<ul>
<li>Defines attributes for path names</li>
<li>Can enforce the correct line ending</li>
<li>Can provide ways to diff binary file (by conversion to text, needs configuration)</li>
<li>Example:</li>
</ul>
<pre tabindex="0"><code class="language-.gitattributes" data-lang=".gitattributes">* text=auto eol=lf
*.[cC][mM][dD] text eol=crlf
*.[bB][aA][tT] text eol=crlf
*.[pP][sS]1 text eol=crlf
</code></pre></section><section>
<h2 id="distributed-version-control-with-git-a-recap-7">Distributed version control with git: a recap</h2>
<h3 id="git-commit"><code>git commit</code></h3>
<ul>
<li>Create a new <em>changeset</em> with the contents of the stage</li>
<li>Requires a <strong>message</strong></li>
<li>Using appropriate messages is <strong>extremely important</strong></li>
</ul>
<h3 id="head"><em>HEAD</em></h3>
<ul>
<li>Pointer to the current commit</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-8">Distributed version control with git: a recap</h2>
<h3 id="git-tag--a"><code>git tag -a</code></h3>
<ul>
<li>Associates a <strong>symbolic name</strong> to a commit</li>
<li>Often used for <strong>versioning</strong></li>
<li>Advanced uses in <strong>Laboratory of Software Systems</strong></li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-9">Distributed version control with git: a recap</h2>
<h3 id="branch"><em>Branch</em></h3>
<ul>
<li>A <strong>named</strong> development line
<br>
<img src="branches.svg" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>
</li>
</ul>
<h3 id="master"><code>master</code></h3>
<ul>
<li>Default branch name
<ul>
<li>legacy of BitKeeper</li>
<li>Modern versions of git let user select</li>
<li>Some prefer <code>main</code></li>
</ul>
</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-10">Distributed version control with git: a recap</h2>
<h3 id="git-checkout"><code>git checkout</code></h3>
<ul>
<li>Moves <em>HEAD</em> across commits</li>
<li>Used to switch <em>branches</em></li>
<li>Can be used to create new <em>branches</em> (with <code>-b</code>)</li>
</ul>
<h3 id="detached-head"><em>detached HEAD</em></h3>
<ul>
<li>Special mode in which commits are not saved</li>
<li>The system goes in <em>detached HEAD</em> when <em>HEAD</em> is not the last commit on a <em>branch</em></li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-11">Distributed version control with git: a recap</h2>
<h3 id="git-branch"><code>git branch</code></h3>
<ul>
<li>Controls creation, visualization, and deletion (<code>-d</code>) of branches</li>
</ul>
<h3 id="git-merge"><code>git merge</code></h3>
<ul>
<li><strong>Unifies</strong> a target branch with the current branch</li>
<li>Creates a <em>merge commit</em></li>
<li>The merging algorithm is configurable</li>
<li><strong>Conflicts</strong> must be solved manually</li>
</ul>
<h3 id="fast-forward"><em>fast-forward</em></h3>
<ul>
<li>A special merge mode applicable when a branch is behind another</li>
<li>The merge behind is updated without a commit</li>
<li>Active by default, can be disabled (<code>--no-ff</code>)</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-12">Distributed version control with git: a recap</h2>
<h3 id="remote"><em>Remote</em></h3>
<ul>
<li>(possibly remote) locations hosting copies of branches of this repository exist</li>
</ul>
<h3 id="git-remote"><code>git remote</code></h3>
<ul>
<li>Configures the <em>remotes</em></li>
</ul>
<h3 id="upstream"><em>upstream</em></h3>
<ul>
<li>The default <em>remote</em> for network operations.</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-13">Distributed version control with git: a recap</h2>
<h3 id="git-clone"><code>git clone</code></h3>
<ul>
<li>Copies a repository from a possibly remote location.</li>
<li>Alternative to <code>init</code></li>
<li>Automatically sets the local branch <em>upstream</em> to the cloned location.</li>
</ul>
</section><section>
<h2 id="distributed-version-control-with-git-a-recap-14">Distributed version control with git: a recap</h2>
<h3 id="git-fetch-remote"><code>git fetch &lt;remote&gt;</code></h3>
<ul>
<li><strong>Updates</strong> the state of <code>&lt;remote&gt;</code></li>
<li>If remote is omitted, updates the state of the branch <em>upstream</em>&rsquo;s <em>remote</em></li>
</ul>
<h3 id="git-pull-remote-branch"><code>git pull &lt;remote&gt; &lt;branch&gt;</code></h3>
<ul>
<li><strong>Shortcut</strong> for <code>git fetch &amp;&amp; git merge FETCH_HEAD</code></li>
</ul>
<h3 id="git-push-remote-branch"><code>git push &lt;remote&gt; &lt;branch&gt;</code></h3>
<ul>
<li>Sends local changes <em>remote</em> <em>branch</em></li>
<li>Requires branches to <strong>share a root</strong></li>
<li>If remote and branch are omitted, updates are sent to the <em>upstream</em></li>
</ul>
</section><section>
<h2 id="advanced-git">Advanced git</h2>
<p>Discussed in <strong>Laboratory of Software Systems</strong></p>
<ul>
<li>Lightweight vs. annotated tagging</li>
<li>Stashing</li>
<li>Rebasing</li>
<li>Rebased pulling</li>
<li>Squashing</li>
<li>Cherry picking</li>
<li>Submodules</li>
<li>Hooks</li>
</ul>
</section><section>
<h2 id="best-practices">Best practices</h2>
<ul>
<li>The CLI is your truth
<ul>
<li>Beware of the GUIs</li>
</ul>
</li>
<li>Prepare an ignore list early
<ul>
<li>And maintain it</li>
<li>And maybe prepare it manually and don&rsquo;t copy/paste it</li>
</ul>
</li>
<li>When you have untracked files, decide whether you want to track them or ignore them</li>
<li>Be very careful with <em>what</em> you track</li>
<li>Prepare an attribute file</li>
</ul>
</section><section>
<h2 id="github">GitHub</h2>
<ul>
<li>Hosting for git repositories</li>
<li>Free for open source</li>
<li>Some limitations for closed source</li>
<li>Academic accounts</li>
<li>De-facto standard for open source projects</li>
<li>One static website per-project, per-user, and per-organization
<ul>
<li>first-class support for Jellyll (a Ruby framework for static website generation)</li>
</ul>
</li>
</ul>
</section><section>
<h1 id="dvcs-workflows">DVCS: Workflows</h1>
<blockquote>
<p>with great power comes great responsibility</p>
</blockquote>
<p>and also</p>
<blockquote>
<p>power is nothing without control</p>
</blockquote>
<p>Elements to consider:</p>
<ul>
<li>How <em>large</em> is the team?</li>
<li>How <em>complex</em> is the project?</li>
<li>Do team members work <em>together</em> (in spacetime)?</li>
<li>Do team members <em>trust</em> each other?</li>
</ul>
</section><section>
<h2 id="trunk-based-development-like">Trunk-based development(-like)</h2>
<p>Single branch, shared truth repository, frequent merges
<br>
<img src="2021-04-14-dvcs-sink.svg" style='
    
    
    max-width: 95vw;
    max-height: 55vh;
    object-fit: contain;
'>
</p>
<ul>
<li><em>Small</em> teams, <em>low-complexity</em> projects, <em>colocated</em> teams, <em>high</em> trust</li>
<li>Typical of small company projects</li>
</ul>
</section><section>
<h2 id="git-flow-classic">Git flow (classic)</h2>
<p>Multiple branches, shared truth repository
<br>
<img src="2021-04-14-dvcs-flow-sink.svg" style='
    
    
    max-width: 95vw;
    max-height: 55vh;
    object-fit: contain;
'>
</p>
<ul>
<li><em>Large</em> teams, <em>high-complexity</em> projects, <em>preferably colocated</em> teams, <em>high</em> trust</li>
<li>Typical of large company projects</li>
</ul>
</section><section>
<h2 id="git-flow-structure">Git flow structure</h2>
<img src="2021-04-13-gitflow.svg" style='
    
    
    max-width: 95vw;
    max-height: 55vh;
    object-fit: contain;
'>

</section><section>
<h2 id="forks-versus-branches">Forks versus branches</h2>
<ul>
<li>In Git, separate <em>development lines</em> are separate <em>branches</em></li>
<li>However, everyone has a <em>copy</em> of the <em>same repository</em></li>
<li>Git <em>hosting services</em> can <em>identify copies</em> of the same project belonging to different users</li>
</ul>
<p>These copies are called <strong>forks</strong></p>
<ul>
<li>Branches on one fork can be requested to be merged on another fork
<ul>
<li>With <strong>merge request</strong> (also called <strong>pull request</strong>, depending on the host)</li>
</ul>
</li>
<li>Pull requests enable easier code review
<ul>
<li>Necessary when the developer <em>does not trust</em> the contributor</li>
<li>But very useful anyway</li>
</ul>
</li>
<li>Working with pull requests is <strong>not part of git</strong> and <em>requires host support</em>
<ul>
<li>GitHub, GitLab, and Bitbucket all support pull requests</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="single-branch-multiple-forks">Single branch, multiple forks</h2>
<ul>
<li>Single branch, multiple independent repository copies</li>
</ul>
<p>
<img src="2021-04-14-dvcs-fork.svg" style='
    
    
    max-width: 95vw;
    max-height: 55vh;
    object-fit: contain;
'>

</p>
<ul>
<li><em>Unknown</em> team size, <em>low-complexity</em> projects, <em>sparse</em> teams, <em>low</em> trust</li>
<li>Typical of small open source projects</li>
</ul>
</section><section>
<h2 id="git-flow-over-multiple-forks">Git flow over multiple forks</h2>
<ul>
<li>Single branch, multiple independent repository copies</li>
</ul>
<p>
<img src="2021-04-14-dvcs-flow-fork.svg" style='
    
    
    max-width: 95vw;
    max-height: 55vh;
    object-fit: contain;
'>

</p>
<ul>
<li><em>Unknown</em> team size, <em>high-complexity</em> projects, <em>sparse</em> teams, <em>low</em> trust</li>
<li>Typical of complex source projects</li>
</ul>
</section><section>
<h1 id="documenting-projects-using-github">Documenting projects using GitHub</h1>
<p>Documentation of a project is <strong>part of the project</strong></p>
<ul>
<li><strong>Documentation</strong> must stay in the same repository of the project</li>
<li>However, it should be <em>accessible to non-developers</em></li>
</ul>
<p>Meet GitHub Pages</p>
<ul>
<li>GitHub provides an <em>automated</em> way to publish <em>webpages from <strong>Markdown</strong></em> text</li>
<li>Markdown is a <em>human readable markup language</em>, <a href="https://learnxinyminutes.com/docs/markdown/">easy to learn</a>
<ul>
<li>These slides are written in Markdown</li>
<li>(generation is a bit richer, but just to make the point)</li>
</ul>
</li>
<li>Supports <em>Jekyll</em> (a Ruby framework for static website generation) out of the box
<ul>
<li>We will not discuss it today</li>
<li>But maybe in LSS&hellip;</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="setting-up-a-github-pages-website">Setting up a GitHub Pages website</h2>
<p>Two possibilities:</p>
<ol>
<li>Select a branch to host the pages
<ul>
<li>Create an orphan branch with <code>git checkout --orphan &lt;branchname&gt;</code></li>
<li>Write your website, one Markdown per page</li>
<li>Push the new branch</li>
</ul>
</li>
<li>Use a <code>docs/</code> folder in a root of some branch
<ul>
<li>Could be <code>master</code> or any other branch</li>
</ul>
</li>
</ol>
</section><section>
<h2 id="setting-up-a-github-pages-website-1">Setting up a GitHub Pages website</h2>
<p>Once done, enable GitHub pages on the repository settings:
<img src="gh-pages.png" style='
    
    
    max-width: 95vw;
    max-height: 80vh;
    object-fit: contain;
'>
</p>
</section><section>
<h2 id="github-pages-urls">GitHub Pages URLs</h2>
<ul>
<li>Repository web-pages are available at <code>https://&lt;username&gt;.github.io/&lt;reponame&gt;</code></li>
<li>User web-pages are available at <code>https://&lt;username&gt;.github.io/</code>
<ul>
<li>They are generated from a repository named <code>&lt;username&gt;.github.io</code></li>
</ul>
</li>
<li>Organization web-pages are available at <code>https://&lt;organization&gt;.github.io/</code>
<ul>
<li>They are generated from a repository named <code>&lt;organization&gt;.github.io</code></li>
</ul>
</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
  <h1 id="the-build-life-cycle">The build &ldquo;life cycle&rdquo;</h1>
<h4 id="not-to-be-confused-with-the-system-development-life-cycle-sdlc">(Not to be confused with the system development life cycle (SDLC))</h4>
<p>The process of creating <em>tested deployable software artifacts</em>
<br/>
from <em>source</em> code</p>
<p>May include, depending on the system specifics:</p>
<ul>
<li><em>Source code manipulation</em> and generation</li>
<li>Source code <em>quality assurance</em></li>
<li><em>Dependency management</em></li>
<li><em>Compilation</em>, linking</li>
<li><em>Binary manipulation</em></li>
<li><em>Test execution</em></li>
<li>Test <em>quality assurance</em> (e.g., coverage)</li>
<li>API <em>documentation</em></li>
<li><em>Packaging</em></li>
<li><em>Delivery</em></li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="lifecycle-styles">Lifecycle styles</h1>
<ul>
<li>
<p><strong>Custom</strong>: select some phases that the product needs and perform them.</p>
<ul>
<li><em>Flexible and configurable</em>: tailored on each project&rsquo;s needs</li>
<li><em>Hard to adapt and port</em></li>
</ul>
</li>
<li>
<p><strong>Standard</strong>: run a sequence of pre-defined actions/phases.</p>
<ul>
<li><em>Portable and easy to understand</em>: replicated on every product</li>
<li><em>Limited configuration options</em></li>
</ul>
</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h1 id="build-automation">Build automation</h1>
<p>Automation of the build lifecycle</p>
<ul>
<li>In principle, the lifecycle could be executed manually</li>
<li>In reality <em>time is precious</em> and <em>repetitivy is boring</em></li>
</ul>
<p>$\Rightarrow$ Create software that automates the building of some software!</p>
<ul>
<li>All those concerns that hold for sofware creation hold for build systems creation&hellip;</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h2 id="build-automation-basics-and-styles">Build automation: basics and styles</h2>
<p>Different lifecycle types generate different build automation <strong>styles</strong></p>
<p><strong>Imperative</strong>: write a script that tells the system what to do to get
from code to artifacts</p>
<ul>
<li><em>Examples</em>: make, cmake, Apache Ant</li>
<li><em>Abstraction gap</em>: verbose, repetitive</li>
<li>Configuration (<em>declarative</em>) and actionable (<em>imperative</em>) logics <em>mixed</em> together</li>
<li>Highly <em>configurable</em></li>
</ul>
<p><strong>Declarative</strong>: adhere to some convention, customizing some settings</p>
<ul>
<li><em>Examples</em>: Apache Maven</li>
<li>Separation between <em>what</em> to do and <em>how</em> to do it
<ul>
<li>The build system decides how to do the stuff</li>
</ul>
</li>
<li><em>Configuration limited</em> by the provided options</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide>
<h2 id="hybrid-automators">Hybrid automators</h2>
<p>Create a <em>declarative infrastructure</em> upon an <em>imperative basis</em>, and
<em>allow easy access to the underlying machinery</em></p>
<p><strong>DSL</strong>s are helpful in this context: they can &ldquo;hide&rdquo; imperativity without ruling it out</p>
<p>Still, many challenges remain open:</p>
<ul>
<li>How to reuse the build logic?
<ul>
<li>within a project, and among projects</li>
</ul>
</li>
<li>How to structure multiple logical and interdependent parts?</li>
</ul>
</section><section>
<h1 id="dependency-management">Dependency management</h1>
<ul>
<li>Any software <strong>depends</strong> on other software
<ul>
<li>The <em>runtime environment</em> (think of the Java Virtual Machine)</li>
<li>The <em>core libraries</em> (e.g., <code>java.*</code>, or <code>scala.*</code>, or <code>kotlin.*</code>)</li>
<li>Possibly <em>third-party libraries</em> (e.g., Google Guava, Apache Commons&hellip;)</li>
<li>Possibly <em>external resources</em> (e.g., images, sounds, translation files&hellip;)</li>
</ul>
</li>
<li>Normally, this <em>software depends on other software</em>
<ul>
<li>That <em>depends on other software</em>
<ul>
<li>That <em>depends on other software</em>
<ul>
<li>That <em>depends on other software</em>, and so on&hellip;</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>A normal applications has a <strong>tree</strong> of dependencies</li>
</ul>
</section><section>
<h2 id="simple-example-print-titles">Simple example: print titles</h2>
<p>Example <strong>requirements</strong>:</p>
<ul>
<li><em>Visit TheTVDB</em>.org (public TV Series database)</li>
<li><em>Search</em> for a TV series (e.g., Breaking Bad)</li>
<li><em>Download</em> and <em>print</em> titles of all episodes</li>
</ul>
</section><section>
<div style='position: relative; padding-bottom: 56.25%; padding-top: 35px; height: 0; overflow: hidden;'>
    <iframe
        sandbox='allow-scripts allow-same-origin'
        allowfullscreen='true'
        allowtransparency='true'
        frameborder='0'
        height='315'
        src='https://www.mentimeter.com/embed/66b4eb67105e9c1fa3916b9344d6b8ad/a62cf5c48ed8'
        style='position: absolute; top: 0; left: 0; width: 100%; height: 100%;'
        width='420'
        >
    </iframe>
</div>
</section><section>
<h2 id="actual-result">Actual result</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">package</span> <span style="color:#b06;font-weight:bold">it.unibo.ci</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">com.uwetrottmann.thetvdb.TheTvdb</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">org.apache.commons.io.IOUtils</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">retrofit2.Response</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.io.IOException</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.util.Objects</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.util.Optional</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.util.stream.IntStream</span>;
<span style="color:#080;font-weight:bold">import static</span> <span style="color:#b06;font-weight:bold">java.nio.charset.StandardCharsets.UTF_8</span>;
<span style="color:#080;font-weight:bold">import static</span> <span style="color:#b06;font-weight:bold">org.jooq.lambda.Unchecked.intFunction</span>;

<span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">final</span> <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">PrintBreakingBad</span> {

    <span style="color:#080;font-weight:bold">private</span> <span style="color:#06b;font-weight:bold">PrintBreakingBad</span>() { }

    <span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">static</span> <span style="color:#888;font-weight:bold">void</span> <span style="color:#06b;font-weight:bold">main</span>(String... args) <span style="color:#080;font-weight:bold">throws</span> IOException {
        <span style="color:#080;font-weight:bold">final</span> TheTvdb api = <span style="color:#080;font-weight:bold">new</span> TheTvdb(IOUtils.<span style="color:#369">toString</span>(ClassLoader.<span style="color:#369">getSystemResource</span>(<span style="color:#d20;background-color:#fff0f0">&#34;APIKey&#34;</span>), UTF_8));
        Optional.<span style="color:#369">of</span>(api.<span style="color:#369">search</span>().<span style="color:#369">series</span>(<span style="color:#d20;background-color:#fff0f0">&#34;Breaking Bad&#34;</span>, <span style="color:#080;font-weight:bold">null</span>, <span style="color:#080;font-weight:bold">null</span>, <span style="color:#080;font-weight:bold">null</span>, <span style="color:#d20;background-color:#fff0f0">&#34;it&#34;</span>).<span style="color:#369">execute</span>())
            .<span style="color:#369">filter</span>(Response::isSuccessful)
            .<span style="color:#369">flatMap</span>(response -&gt; response.<span style="color:#369">body</span>().<span style="color:#369">data</span>.<span style="color:#369">stream</span>().<span style="color:#369">findFirst</span>())
            .<span style="color:#369">stream</span>()
            .<span style="color:#369">flatMap</span>(serie -&gt; <span style="color:#888">// Every serie becomes a stream of pages
</span><span style="color:#888"></span>                IntStream.<span style="color:#369">iterate</span>(1, it -&gt; it + 1)
                    .<span style="color:#369">mapToObj</span>(intFunction(page -&gt; api.<span style="color:#369">series</span>().<span style="color:#369">episodes</span>(serie.<span style="color:#369">id</span>, page, <span style="color:#d20;background-color:#fff0f0">&#34;it&#34;</span>).<span style="color:#369">execute</span>()))
                    .<span style="color:#369">takeWhile</span>(Response::isSuccessful)
            )
            .<span style="color:#369">flatMap</span>(it -&gt; it.<span style="color:#369">body</span>().<span style="color:#369">data</span>.<span style="color:#369">stream</span>()) <span style="color:#888">// every page becomes a stream of episodes
</span><span style="color:#888"></span>            .<span style="color:#369">map</span>(it -&gt; it.<span style="color:#369">episodeName</span>)
            .<span style="color:#369">filter</span>(Objects::nonNull)
            .<span style="color:#369">forEach</span>(System.<span style="color:#369">out</span>::println);
        System.<span style="color:#369">exit</span>(0);
    }
}
</code></pre></div>
</section><section>
<h2 id="the-trick-using-a-few-libraries">The trick: using a few libraries</h2>
<ul>
<li><strong>Jooq Jooλ</strong>
<ul>
<li>Unchecked lambda functions</li>
</ul>
</li>
<li><strong>Apache Commons I/O</strong>
<ul>
<li><code>Resource</code> to <code>String</code></li>
</ul>
</li>
<li>A <strong>library for TheTVDB</strong>
<ul>
<li>Queries TheTVDB given a valid API key, hiding HTTP, communication, and parsing</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="actual-dependency-tree">Actual dependency tree</h2>
<pre tabindex="0"><code>+--- commons-io:commons-io:+ -&gt; 2.8.0
+--- com.uwetrottmann.thetvdb-java:thetvdb-java:+ -&gt; 2.4.0
|    +--- com.squareup.retrofit2:retrofit:2.6.2
|    |    \--- com.squareup.okhttp3:okhttp:3.12.0
|    |         \--- com.squareup.okio:okio:1.15.0
|    \--- com.squareup.retrofit2:converter-gson:2.6.2
|         +--- com.squareup.retrofit2:retrofit:2.6.2 (*)
|         \--- com.google.code.gson:gson:2.8.5
\--- org.jooq:jool-java-8:+ -&gt; 0.9.14
</code></pre><ul>
<li>three <em>direct</em> dependencies</li>
<li>six <em>transitive</em> dependencies</li>
</ul>
<p>In large projects, <em>transitive</em> dependencies often dominate</p>
</section><section>
<h2 id="towards-a-dependency-hell">Towards a <strong>dependency hell</strong></h2>
<ul>
<li>It&rsquo;s common for non-toy projects to get past 50 dependencies</li>
<li><em>Searching</em>, <em>downloading</em> and <em>verifying compatibility</em> by hand is unbearable</li>
<li><strong>Version conflicts</strong> arise soon
<ul>
<li>one of your direct dependencies uses library A at version 1</li>
<li>another uses library A at version 2</li>
<li>$\Rightarrow$  <em>transitive dependency conflict</em> on A</li>
</ul>
</li>
<li><strong>Upgrading</strong> by hand requires, <em>time</em>, <em>effort</em> and <em>tons of testing</em></li>
</ul>
</section><section>
<h2 id="dealing-with-dependencies">Dealing with dependencies</h2>
<p><strong>Source import</strong></p>
<p>Duplication, more library code than business code, updates almost impossible, inconsistencies, unmaintainable</p>
<p><strong>Binary import</strong></p>
<p>Hard to update, <a href="https://bitbucket.org/danysk/exploded-repository-example">toxic for the VCS</a></p>
<p><strong>Desiderata</strong></p>
<ul>
<li><em>Declarative</em> specification of libraries and versions</li>
<li><em>Automatic retrieval</em></li>
<li>Automatic <em>resolution of transitive dependencies</em></li>
<li>Dependency <strong>scopes</strong>
<ul>
<li>You may need <em>compile-only</em>, <em>test-only</em>, and <em>runtime-only</em> dependencies</li>
</ul>
</li>
<li>Customizable software <em>sources</em></li>
</ul>
</section><section>
<h1 id="gradle">Gradle</h1>
<p>A paradigmatic example of a hybrid automator:</p>
<ul>
<li>Written mostly in Java</li>
<li>with an outer Groovy DSL</li>
<li>&hellip;and, more recently, a Kotlin DSL</li>
</ul>
<h3 id="our-approach-to-gradle">Our approach to Gradle</h3>
<ul>
<li>We are going to learn <em>a bit of how to use</em> Gradle for <em>simple JVM projects</em>
<ul>
<li>Mostly by example</li>
</ul>
</li>
<li>We are <strong>not</strong> going to <em>learn Gradle</em>
<ul>
<li>Again, this is done in LSS for those interested</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="gradle-main-concepts">Gradle: main concepts</h2>
<ul>
<li><strong>Project</strong> &ndash; A collection of files composing the software
<ul>
<li>The <em>root</em> project can contain <em>subprojects</em></li>
</ul>
</li>
<li><strong>Build file</strong> &ndash; A special file, with the build information
<ul>
<li>situated in the root directory of a project</li>
<li>instructs Gradle on the organization of the project</li>
</ul>
</li>
<li><strong>Dependency</strong> &ndash; A resource required by some operation.
<ul>
<li>May have dependencies itself</li>
<li>Dependencies of dependencies are called <em>transitive</em> dependencies</li>
</ul>
</li>
<li><strong>Configuration</strong> &ndash; A group of dependencies with <em>three roles</em>:
<ol>
<li><em>Declare</em> dependencies</li>
<li><em>Resolve</em> dependency declarations to actual artifacts/resources</li>
<li><em>Present</em> the dependencies to consumers in a suitable format</li>
</ol>
</li>
<li><strong>Task</strong> &ndash; An atomic operation on the project, which can:
<ul>
<li>have input and output files</li>
<li>depend on other tasks (can be executed only if those are completed)</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="gradle-under-the-hood">Gradle: under the hood</h2>
<ul>
<li>The Gradle build script is <em>a valid Kotlin script</em> (using the Gradle API)</li>
<li>Anything that has not a valid <em>Kotlin syntax</em> is not a valid Gradle build script</li>
<li><em>Kotlin</em> and <em>Groovy</em> picked as they allow <em>easy DSL creation</em></li>
<li>The <em>feeling</em> is to just have <em>to configure</em> an existing software
<ul>
<li><em>Declarative</em>, much like Maven plugins</li>
</ul>
</li>
<li>When needed, it is easy to configure <em>custom behaviour</em>
<ul>
<li>fiddle with internals</li>
<li>write in functional or imperative fashion</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="gradle-minimal-java-build">Gradle: minimal java build</h2>
<ul>
<li>By default, Gradle inherits the maven convention for source organization:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>+-- src <span style="color:#888"># All sources</span>
    +-- main <span style="color:#888"># One folder per &#34;source set&#34;, all code in a source set shares dependencies</span>
    |   +-- java <span style="color:#888"># One folder per language</span>
    |   +-- kotlin
    |   +-- resources <span style="color:#888"># Resources go here</span>
    |   \-- scala
    \-- <span style="color:#038">test</span> <span style="color:#888"># Test sources are separated, different dependencies        </span>
        +-- java <span style="color:#888"># Same structure as main</span>
        +-- kotlin
        +-- resources <span style="color:#888"># Resources go here</span>
        \-- scala
</code></pre></div></section><section>
<h2 id="gradle-minimal-java-build-1">Gradle: minimal java build</h2>
<p><code>src/main/java/HelloWorld.java</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">HelloWorld</span> {

    <span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">static</span> <span style="color:#888;font-weight:bold">void</span> <span style="color:#06b;font-weight:bold">main</span>(String... args) {
        System.<span style="color:#369">out</span>.<span style="color:#369">println</span>(<span style="color:#d20;background-color:#fff0f0">&#34;Hello, world!&#34;</span>);
    }
    
}
</code></pre></div>
<p><code>build.gradle.kts</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>plugins { java }
</code></pre></div>
<p>Yes, it&rsquo;s a one-liner</p>
</section><section>
<h2 id="gradle-minimal-example-execution">Gradle: minimal example execution</h2>
<ul>
<li>The <code>gradle</code> command accepts the names of <em>tasks</em>  to execute as parameters</li>
<li>The <code>java</code> plugin introduces several tasks:
<ul>
<li><code>compile&lt;source set&gt;&lt;language name&gt;</code> (e.g., <code>compileTestJava</code>): compiles a specific source set</li>
<li><code>compile&lt;language name&gt;</code>: compiles all source sets of a language</li>
<li><code>build</code>: runs all compilation tasks</li>
<li><code>tasks</code>: displays available tasks
<ul>
<li>usually used as <code>tasks --all</code> to show also <em>uncategorized</em> tasks</li>
</ul>
</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="dependency-management-in-gradle">Dependency management in Gradle</h2>
<p><code>repositories</code></p>
<ul>
<li>Where to retrieve software from
<ul>
<li>suggested ones are <code>mavenCentral()</code> and <code>google()</code></li>
<li><code>jcenter()</code> is common but sunsetted (May 2021), <em>do not use it</em></li>
</ul>
</li>
</ul>
</section><section>
<h2 id="dependency-management-in-gradle-1">Dependency management in Gradle</h2>
<p><code>dependencies</code></p>
<ul>
<li>Separated by <strong>scope</strong>
<ul>
<li>Scopes define <em>when</em> a dependency should be available
<ul>
<li><code>api</code> (libraries only): abstractions are exposed publicly and clients are expected to use them</li>
<li><code>implementation</code>: used internally, clients should not care</li>
<li><code>testImplementation</code>: used to compile and run tests</li>
<li>(<code>test</code>)<code>compileOnly</code>: only available when compiling (typically used for annotations)</li>
<li>(<code>test</code>)<code>runtimeOnly</code>: only required at runtime (typically used when components are loaded reflectively)</li>
</ul>
</li>
<li>Scopes map to <strong>configurations</strong></li>
</ul>
</li>
<li>Specified as <code>&lt;group&gt;:&lt;artifact&gt;:&lt;version&gt;</code>
<ul>
<li><code>+</code> is a special marker for &ldquo;latest&rdquo;</li>
<li>Maven-style ranges supported (e.g., (1.2, 1.4])</li>
</ul>
</li>
<li>Transitive dependencies are resolved automatically (if available in some repository)</li>
</ul>
</section><section>
<h2 id="the-build-system-as-dependency">The build system as dependency</h2>
<ul>
<li>
<p><em>no guarantee</em>  that automation written with some tool at version <code>X</code>, will work at version <code>Y</code>!</p>
</li>
<li>
<p>$\Rightarrow$ <strong>The build system is itself a dependency</strong></p>
</li>
<li>
<p>A global dependency on the build tool is <strong>hard to capture</strong></p>
</li>
<li>
<p>Often, it becomes a <em>prerequisite expressed in natural language</em></p>
<ul>
<li>e.g., &ldquo;you need Maven 3.6.1 to build this software&rdquo;</li>
</ul>
</li>
<li>
<p><em>Critical</em> issues when different pieces of the same system depend on different build tool versions</p>
</li>
</ul>
</section><section>
<h2 id="the-gradle-wrapper">The Gradle wrapper</h2>
<p>Gradle proposes a (partial) solution with the so-called <em>Gradle wrapper</em></p>
<ul>
<li><em>A minimal program</em> that simply downloads the version of gradle written in a configuration file</li>
<li><em>Generable</em> with the built-in task <code>wrapper</code>
<ul>
<li><code>gradle wrapper --gradle-version=&lt;VERSION&gt;</code></li>
</ul>
</li>
<li>Prepares scripts for bash and cmd to run Gradle at the specified version
<ul>
<li><code>gradlew</code></li>
<li><code>gradlew.bat</code></li>
</ul>
</li>
</ul>
<p>The Gradle wrapper is <em><strong>the</strong> correct way</em> to use gradle, and we&rsquo;ll be using it from now on.</p>
</section><section>
<h2 id="gradle-our-toy-example">Gradle: our toy example</h2>
<p><code>src/main/java/it/unibo/ci/PrintBreakingBad.java</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">package</span> <span style="color:#b06;font-weight:bold">it.unibo.ci</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">com.uwetrottmann.thetvdb.TheTvdb</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">org.apache.commons.io.IOUtils</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">retrofit2.Response</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.io.IOException</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.util.Objects</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.util.Optional</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">java.util.stream.IntStream</span>;
<span style="color:#080;font-weight:bold">import static</span> <span style="color:#b06;font-weight:bold">java.nio.charset.StandardCharsets.UTF_8</span>;
<span style="color:#080;font-weight:bold">import static</span> <span style="color:#b06;font-weight:bold">org.jooq.lambda.Unchecked.intFunction</span>;

<span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">final</span> <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">PrintBreakingBad</span> {

    <span style="color:#080;font-weight:bold">private</span> <span style="color:#06b;font-weight:bold">PrintBreakingBad</span>() { }

    <span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">static</span> <span style="color:#888;font-weight:bold">void</span> <span style="color:#06b;font-weight:bold">main</span>(String... args) <span style="color:#080;font-weight:bold">throws</span> IOException {
        <span style="color:#080;font-weight:bold">final</span> TheTvdb api = <span style="color:#080;font-weight:bold">new</span> TheTvdb(IOUtils.<span style="color:#369">toString</span>(ClassLoader.<span style="color:#369">getSystemResource</span>(<span style="color:#d20;background-color:#fff0f0">&#34;APIKey&#34;</span>), UTF_8));
        Optional.<span style="color:#369">of</span>(api.<span style="color:#369">search</span>().<span style="color:#369">series</span>(<span style="color:#d20;background-color:#fff0f0">&#34;Breaking Bad&#34;</span>, <span style="color:#080;font-weight:bold">null</span>, <span style="color:#080;font-weight:bold">null</span>, <span style="color:#080;font-weight:bold">null</span>, <span style="color:#d20;background-color:#fff0f0">&#34;it&#34;</span>).<span style="color:#369">execute</span>())
            .<span style="color:#369">filter</span>(Response::isSuccessful)
            .<span style="color:#369">flatMap</span>(response -&gt; response.<span style="color:#369">body</span>().<span style="color:#369">data</span>.<span style="color:#369">stream</span>().<span style="color:#369">findFirst</span>())
            .<span style="color:#369">stream</span>()
            .<span style="color:#369">flatMap</span>(serie -&gt; <span style="color:#888">// Every serie becomes a stream of pages
</span><span style="color:#888"></span>                IntStream.<span style="color:#369">iterate</span>(1, it -&gt; it + 1)
                    .<span style="color:#369">mapToObj</span>(intFunction(page -&gt; api.<span style="color:#369">series</span>().<span style="color:#369">episodes</span>(serie.<span style="color:#369">id</span>, page, <span style="color:#d20;background-color:#fff0f0">&#34;it&#34;</span>).<span style="color:#369">execute</span>()))
                    .<span style="color:#369">takeWhile</span>(Response::isSuccessful)
            )
            .<span style="color:#369">flatMap</span>(it -&gt; it.<span style="color:#369">body</span>().<span style="color:#369">data</span>.<span style="color:#369">stream</span>()) <span style="color:#888">// every page becomes a stream of episodes
</span><span style="color:#888"></span>            .<span style="color:#369">map</span>(it -&gt; it.<span style="color:#369">episodeName</span>)
            .<span style="color:#369">filter</span>(Objects::nonNull)
            .<span style="color:#369">forEach</span>(System.<span style="color:#369">out</span>::println);
        System.<span style="color:#369">exit</span>(0);
    }
}
</code></pre></div>
</section><section>
<h2 id="gradle-our-toy-example-1">Gradle: our toy example</h2>
<p><code>build.gradle.kts</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>plugins {
    java
    application
}
repositories {
    mavenCentral()
}
dependencies {
    implementation(<span style="color:#d20;background-color:#fff0f0">&#34;commons-io:commons-io:+&#34;</span>)
    implementation(<span style="color:#d20;background-color:#fff0f0">&#34;com.uwetrottmann.thetvdb-java:thetvdb-java:+&#34;</span>)
    implementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.jooq:jool-java-8:+&#34;</span>)
}
application {
    mainClassName = <span style="color:#d20;background-color:#fff0f0">&#34;it.unibo.ci.PrintBreakingBad&#34;</span> 
}
</code></pre></div>
<p><code>settings.gradle.kts</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>rootProject.name = <span style="color:#d20;background-color:#fff0f0">&#34;dependency-management&#34;</span>
</code></pre></div>
</section><section>
<h2 id="gradle-toy-example-execution">Gradle: toy example execution</h2>
<ul>
<li>The <code>application</code> plugin introduces a <code>run</code> task:
<ul>
<li>Depends on <code>build</code></li>
<li>runs the specified main class passing the <code>runtimeClasspath</code> to the <code>-cp</code> option of <code>java</code></li>
<li><code>./gradlew</code> run</li>
</ul>
</li>
</ul>
<p><strong>Note</strong>: exectution requires a valid TheTVDB API Key in a plain text file <code>src/main/resources/APIKey</code></p>
</section><section>
<h2 id="gradle-multi-language-projects">Gradle: multi-language projects</h2>
<p><code>src/main/groovy/HelloGroovy.groovy</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>println <span style="color:#d20;background-color:#fff0f0">&#34;Hello, Groovy&#34;</span>

</code></pre></div>
<p><code>src/main/java/HelloWorld.java</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">HelloWorld</span> {

    <span style="color:#080;font-weight:bold">public</span> <span style="color:#080;font-weight:bold">static</span> <span style="color:#888;font-weight:bold">void</span> <span style="color:#06b;font-weight:bold">main</span>(String... args) {
        System.<span style="color:#369">out</span>.<span style="color:#369">println</span>(<span style="color:#d20;background-color:#fff0f0">&#34;Hello, world!&#34;</span>);
    }
    
}
</code></pre></div>
</section><section>
<h2 id="gradle-multi-language-projects-1">Gradle: multi-language projects</h2>
<p><code>src/main/kotlin/HelloKt.kt</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">fun</span> <span style="color:#06b;font-weight:bold">main</span>() { 
  println(<span style="color:#d20;background-color:#fff0f0">&#34;Hello, world!&#34;</span>) 
}
</code></pre></div>
<p><code>src/main/scala/HelloScala.scala</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">object</span> <span style="color:#b06;font-weight:bold">HelloScala</span> <span style="color:#080;font-weight:bold">extends</span> <span style="color:#b06;font-weight:bold">App</span>  {
    println(<span style="color:#d20;background-color:#fff0f0">&#34;Hello Scala&#34;</span>)
}
</code></pre></div>
</section><section>
<h2 id="gradle-multi-language-projects-2">Gradle: multi-language projects</h2>
<p><code>build.gradle.kts</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>plugins {
    java
    scala
    groovy
    kotlin(<span style="color:#d20;background-color:#fff0f0">&#34;jvm&#34;</span>) version <span style="color:#d20;background-color:#fff0f0">&#34;1.3.31&#34;</span>
}
repositories {
    mavenCentral()
}
dependencies {
    implementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.codehaus.groovy:groovy:2.3.7&#34;</span>)
    implementation(kotlin(<span style="color:#d20;background-color:#fff0f0">&#34;stdlib&#34;</span>))
    implementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.scala-lang:scala-library:2.12.2&#34;</span>)
}
</code></pre></div>
</section><section>
<h1 id="quality-assurance">Quality Assurance</h1>
<p><em>&ldquo;It works&rdquo;</em> <strong>is <em>not</em> good enough</strong></p>
<p>(besides, the very notion of &ldquo;it works&rdquo; is rather debatable)</p>
<ul>
<li>Software quality should be <em>continuously assessed</em></li>
<li>The assessment should <em>automatic</em> whenever possible</li>
<li><strong>QA should be integrated in the build system!</strong>
<ul>
<li>It is fine to <em>fail the build</em> if quality criteria are not met</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="quality-assurance-levels">Quality Assurance: levels</h2>
<ul>
<li><em>Style</em> and <em>coherence</em></li>
<li><em>Flawed programming</em> patterns</li>
<li>Violations of the <em>DRY</em> principle</li>
<li><strong>Testing</strong>
<ul>
<li>Multifaceted issue</li>
<li>To be executed along the whole software lifecycle</li>
<li>$\Rightarrow$ Plenty of detail in upcoming lectures</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="quality-assurance-style-and-coherence">Quality Assurance: style and coherence</h2>
<p>Automated checkers are also called <em>linters</em>, often provide an auto-formatting tool</p>
<p><strong>Idiomatic</strong> and <strong>standardized</strong> code:</p>
<ul>
<li>reduces <em>complexity</em></li>
<li>improves <em>understandandability</em></li>
<li>prevents <em>style-changing commits</em> with <em>unintelligible diffs</em></li>
<li>lowers the <em>maintenance</em> burden and related <em>costs</em></li>
<li>simplifies <em>code reviews</em></li>
</ul>
<p>In <em>Java</em>:
<a href="https://checkstyle.sourceforge.io/">Checkstyle</a>,
<a href="https://pmd.github.io/">PMD</a></p>
<p>In <em>Kotlin</em>:
<a href="https://github.com/JetBrains/inspection-plugin">IDEA Inspection</a>,
<a href="https://ktlint.github.io/">Ktlint</a></p>
<p>In <em>Scala</em>:
<a href="https://scalameta.org/scalafmt/">Scalafmt</a>,
<a href="http://www.scalastyle.org/rules-1.0.0.html">Scalastyle</a></p>
</section><section>
<h2 id="quality-assurance-flawed-programming-patterns">Quality Assurance: flawed programming patterns</h2>
<p>Identification and reporting of <em>patterns</em> known to be <em>problematic</em></p>
<ul>
<li>Early-interception of <em>potential bugs</em></li>
<li>Enforce <em>good programming principles</em></li>
<li>Improves <em>performance</em></li>
<li>Reduces <em>complexity</em></li>
<li>Reduces <em>maintenance cost</em></li>
</ul>
<p>In <em>Java</em>:
<a href="https://pmd.github.io/">PMD</a>,
<a href="https://spotbugs.github.io/">SpotBugs</a></p>
<p>In <em>Kotlin</em>:
<a href="https://detekt.github.io/detekt/">Detekt</a>
<a href="https://github.com/JetBrains/inspection-plugin">IDEA Inspection</a></p>
<p>In <em>Scala</em>:
<a href="htthttps://scalacenter.github.io/scalafix/">Scalafix</a>,
<a href="http://www.wartremover.org/">Wartremover</a></p>
</section><section>
<h2 id="quality-assurance-violations-of-the-dry-principle">Quality Assurance: violations of the DRY principle</h2>
<p>Code <em>replicated</em> rather than <em>reused</em></p>
<ul>
<li>improves <em>understandandability</em></li>
<li>Reduces <em>maintenance cost</em></li>
<li>simplifies <em>code reviews</em></li>
</ul>
<p>General advice: <strong>never copy/paste</strong> your code</p>
<ul>
<li>If you need to copy something, you probably need to <em>refactor</em> something</li>
</ul>
<p>Multi-language tool: <a href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">Copy/Paste Detector (CPD)</a> (part of PMD)</p>
</section><section>
<h2 id="quality-assurance-testing-and-coverage">Quality Assurance: testing and coverage</h2>
<p><strong>Automated</strong> software verification</p>
<ul>
<li>Unit level</li>
<li>Integration testing</li>
<li>End-to-end testing</li>
</ul>
<p>Extension of testing can be evaluated via <strong>coverage</strong>.</p>
<ul>
<li>Coverage tells you <em>how much code is <strong>untested</strong>, not how much is tested</em></li>
</ul>
<p>Several frameworks, recommended ones:</p>
<ul>
<li>Testing for <em>all JVM languages</em>: <a href="https://junit.org/junit5/docs/current/user-guide/">Junit/Jupiter (JUnit 5)</a></li>
<li>Testing for <em>Kotlin</em>: <a href="https://kotest.io/">Kotest</a></li>
<li>Testing for <em>Scala</em>: <a href="https://www.scalatest.org/">Scalatest</a></li>
<li>Coverage for all JVM languages: <a href="https://www.eclemma.org/jacoco/">JaCoCo</a></li>
<li>Coverage for Scala: <a href="http://scoverage.org/">Scoverage</a></li>
</ul>
</section><section>
<h2 id="quality-assurance-junit--gradle">Quality Assurance: JUnit + Gradle</h2>
<p><code>src/main/scala/it/unibo/test/Test.scala</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">package</span> <span style="color:#b06;font-weight:bold">it.unibo.test</span>

<span style="color:#080;font-weight:bold">trait</span> <span style="color:#b06;font-weight:bold">Sometrait</span> {
  <span style="color:#080;font-weight:bold">def</span> f<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Int</span>
  <span style="color:#080;font-weight:bold">def</span> g<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Int</span>
}

<span style="color:#080;font-weight:bold">object</span> <span style="color:#b06;font-weight:bold">Someobject</span> {
  <span style="color:#080;font-weight:bold">def</span> f <span style="color:#080;font-weight:bold">=</span> <span style="color:#00d;font-weight:bold">10</span>
  <span style="color:#080;font-weight:bold">def</span> g <span style="color:#080;font-weight:bold">=</span> <span style="color:#00d;font-weight:bold">77</span>
}
</code></pre></div>
</section><section>
<h2 id="quality-assurance-junit--gradle-1">Quality Assurance: JUnit + Gradle</h2>
<p><code>src/test/scala/MyTest.scala</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">it.unibo.test.</span>{<span style="color:#b06;font-weight:bold">Someobject</span>, <span style="color:#b06;font-weight:bold">Sometrait</span>}
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">org.junit.jupiter.api.Assertions._</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">org.junit.jupiter.api.Test</span>

<span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">MyTest</span> {

  <span style="color:#555">@Test</span>
  <span style="color:#080;font-weight:bold">def</span> emptySetShouldHaveSizeZero()<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Unit</span> = {
    assertEquals(<span style="color:#00d;font-weight:bold">0</span>, <span style="color:#b06;font-weight:bold">Set</span>.empty.size)
  }

  <span style="color:#555">@Test</span>
  <span style="color:#080;font-weight:bold">def</span> thisTestIsActuallyUseless()<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Unit</span> = {
    <span style="color:#080;font-weight:bold">val</span> someStub <span style="color:#080;font-weight:bold">=</span> <span style="color:#080;font-weight:bold">new</span> <span style="color:#b06;font-weight:bold">Sometrait</span> {
      <span style="color:#080;font-weight:bold">override</span> <span style="color:#080;font-weight:bold">def</span> f<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Int</span> = <span style="color:#00d;font-weight:bold">42</span>
      <span style="color:#080;font-weight:bold">override</span> <span style="color:#080;font-weight:bold">def</span> g<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Int</span> = ???
    }
    assertEquals(<span style="color:#00d;font-weight:bold">42</span>, someStub.f)
    assertNotEquals(<span style="color:#b06;font-weight:bold">Someobject</span>.f, someStub.f)
  }
}
</code></pre></div>
</section><section>
<h2 id="quality-assurance-junit--gradle-2">Quality Assurance: JUnit + Gradle</h2>
<p><code>build.gradle.kts</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>plugins {
    java
    scala
    jacoco
}

repositories {
    mavenCentral()
}

dependencies {
    implementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.scala-lang:scala-library:+&#34;</span>)
    testImplementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.junit.jupiter:junit-jupiter-api:+&#34;</span>)
    testRuntimeOnly(<span style="color:#d20;background-color:#fff0f0">&#34;org.junit.jupiter:junit-jupiter-engine:+&#34;</span>)
}

<span style="color:#888">// Enables JUnit Platform (needed for JUnit 5)
</span><span style="color:#888"></span>tasks.named&lt;Test&gt;(<span style="color:#d20;background-color:#fff0f0">&#34;test&#34;</span>) {
    useJUnitPlatform()
}
</code></pre></div>
</section><section>
<h2 id="quality-assurance-scalatest--scoverage">Quality Assurance: Scalatest + Scoverage</h2>
<p>Let&rsquo;s switch <em>testing framework</em> and enable <em>coverage</em></p>
<p><code>src/main/scala/it/unibo/test/Test.scala</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">package</span> <span style="color:#b06;font-weight:bold">it.unibo.test</span>

<span style="color:#080;font-weight:bold">trait</span> <span style="color:#b06;font-weight:bold">Sometrait</span> {
  <span style="color:#080;font-weight:bold">def</span> f<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Int</span>
  <span style="color:#080;font-weight:bold">def</span> g<span style="color:#080;font-weight:bold">:</span> <span style="color:#888;font-weight:bold">Int</span>
}

<span style="color:#080;font-weight:bold">object</span> <span style="color:#b06;font-weight:bold">Someobject</span> {
  <span style="color:#080;font-weight:bold">def</span> f <span style="color:#080;font-weight:bold">=</span> <span style="color:#00d;font-weight:bold">10</span>
  <span style="color:#080;font-weight:bold">def</span> g <span style="color:#080;font-weight:bold">=</span> <span style="color:#00d;font-weight:bold">77</span>
}
</code></pre></div>
</section><section>
<h2 id="quality-assurance-scalatest--scoverage-1">Quality Assurance: Scalatest + Scoverage</h2>
<p><code>src/test/scala/Test.scala</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">it.unibo.test.Sometrait</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">org.scalamock.scalatest.MockFactory</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#b06;font-weight:bold">org.scalatest.funsuite.AnyFunSuite</span>

<span style="color:#080;font-weight:bold">class</span> <span style="color:#b06;font-weight:bold">MyTests</span> <span style="color:#080;font-weight:bold">extends</span> <span style="color:#b06;font-weight:bold">AnyFunSuite</span> <span style="color:#080;font-weight:bold">with</span> <span style="color:#b06;font-weight:bold">MockFactory</span> {
  test(<span style="color:#d20;background-color:#fff0f0">&#34;An empty Set should have size 0&#34;</span>) {
    println(<span style="color:#d20;background-color:#fff0f0">&#34;Test1&#34;</span>)
    assert(<span style="color:#b06;font-weight:bold">Set</span>.empty.size == <span style="color:#00d;font-weight:bold">0</span>)
  }
  test(<span style="color:#d20;background-color:#fff0f0">&#34;Some useless test&#34;</span>) {
    println(<span style="color:#d20;background-color:#fff0f0">&#34;Test2&#34;</span>)
    <span style="color:#080;font-weight:bold">val</span> someStub <span style="color:#080;font-weight:bold">=</span> stub[<span style="color:#888;font-weight:bold">Sometrait</span>]
    (someStub.f <span style="color:#080;font-weight:bold">_</span>).when().returns(<span style="color:#00d;font-weight:bold">42</span>)
    assert(someStub.f == <span style="color:#00d;font-weight:bold">42</span>)
  }
}
</code></pre></div>
</section><section>
<h2 id="quality-assurance-scalatest--scoverage-2">Quality Assurance: Scalatest + Scoverage</h2>
<p><code>build.gradle.kts</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape>plugins {
    java
    scala
    id(<span style="color:#d20;background-color:#fff0f0">&#34;org.scoverage&#34;</span>) version <span style="color:#d20;background-color:#fff0f0">&#34;5.0.0&#34;</span>
    id(<span style="color:#d20;background-color:#fff0f0">&#34;com.github.maiflai.scalatest&#34;</span>) version <span style="color:#d20;background-color:#fff0f0">&#34;0.31&#34;</span>
}

repositories {
    mavenCentral()
}

dependencies {
    implementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.scala-lang:scala-library:+&#34;</span>)
    testImplementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.scalatest:scalatest_2.13:+&#34;</span>)
    testImplementation(<span style="color:#d20;background-color:#fff0f0">&#34;org.scalamock:scalamock_2.13:+&#34;</span>)
    testRuntimeOnly(<span style="color:#d20;background-color:#fff0f0">&#34;com.vladsch.flexmark:flexmark-profile-pegdown:0.36.8&#34;</span>)
    scoverage(<span style="color:#d20;background-color:#fff0f0">&#34;org.scoverage:scalac-scoverage-plugin_2.13:+&#34;</span>)
    scoverage(<span style="color:#d20;background-color:#fff0f0">&#34;org.scoverage:scalac-scoverage-runtime_2.13:+&#34;</span>)
}

<span style="color:#888">// gradle clean reportScoverage
</span></code></pre></div>
</section><section>
<h2 id="gradle-qa-execution">Gradle: QA execution</h2>
<ul>
<li>The <code>java</code> plugin (applied by the <code>scala</code> plugin under the hood) also introduces:
<ul>
<li><code>test</code>: a task that runs all tests</li>
<li><code>check</code>: a task that runs the whole quality assurance suite</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="additional-checks-and-reportings">Additional checks and reportings</h2>
<p>There exist a number of recommended services that provide additional QA and reports.</p>
<p>Non exhaustive list:</p>
<ul>
<li><a href="https://codecov.io/">Codecov.io</a>
<ul>
<li>Code coverage</li>
<li>Supports Jacoco XML reports</li>
<li>Nice data reporting system</li>
</ul>
</li>
<li><a href="https://sonarcloud.io/">Sonarcloud</a>
<ul>
<li>Multiple measures, covering reliability, security, maintainability, duplication, complexity&hellip;</li>
</ul>
</li>
<li><a href="https://www.codacy.com/">Codacy</a>
<ul>
<li>Automated software QA for several languages</li>
</ul>
</li>
<li><a href="https://www.codefactor.io/">Code Factor</a>
<ul>
<li>Automated software QA</li>
</ul>
</li>
</ul>
</section><section>
<h1 id="continuous-integration-1">Continuous Integration</h1>
<p>The practice of integrating code with the main development line <strong>continuously</strong>
<br>
<em>Verifying</em> that the build remains intact</p>
<ul>
<li>Requires <em>build automation</em> to be in place</li>
<li>Requires <em>testing</em> to be in place</li>
<li>Pivot point of the <em>DevOps</em> practices</li>
<li>Historically introduced by the extreme programming (XP) community</li>
<li>Now widespread in the larger DevOps community</li>
</ul>
</section><section>
<h1 id="the-integration-hell">The Integration Hell</h1>
<ul>
<li>Traditional software development takes several months for <em>“integrating”</em> a couple of years of development</li>
<li>The longer there is no integrated project, the higher the <strong>risk</strong></li>
</ul>
<p><img src="integration-traditional.png" style='
    
    
    max-width: 40vw;
    max-height: 50vh;
    object-fit: contain;
'>

<img src="integration-continuous.png" style='
    
    
    max-width: 40vw;
    max-height: 50vh;
    object-fit: contain;
'>
</p>
</section><section>
<h2 id="microreleases-and-protoduction">Microreleases and protoduction</h2>
<ul>
<li>High frequency integration may lead to high frequency releases
<ul>
<li>Possibly, <em>one per commit</em></li>
<li>Of course, <em>versioning</em> must be appropriate&hellip;</li>
</ul>
</li>
</ul>
<p>Traditionally, <strong>protoduction</strong> is jargon for a <em>prototype that ends up in production</em></p>
<img src="protoduction.jpg" style='
    
    
    max-width: 25vw;
    max-height: 40vh;
    object-fit: contain;
'>

<ul>
<li>Traditionally used with a <em>negative</em> meaning
<ul>
<li>It implied software
<ul>
<li><em>unfinished</em>,</li>
<li><em>unpolished</em>,</li>
<li><em>badly designed</em></li>
</ul>
</li>
<li>Very common, unfortunately</li>
</ul>
</li>
<li>This si different in a continuously integrated environment
<ul>
<li><em>Incrementality</em> is fostered</li>
<li>Partial features are <em>up to date</em> with the mainline</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="intensive-operations-should-be-elsewhere">Intensive operations should be elsewhere</h2>
<ul>
<li>The build process should be <em>rich</em> and <em>fast</em></li>
<li>Operations requiring a long time should be <em>automated</em>
<ul>
<li>And run somewhere else than devs' PCs</li>
</ul>
</li>
</ul>
<p>
<img src="compiling.png" style='
    
    
    max-width: 95vw;
    max-height: 50vh;
    object-fit: contain;
'>

</p>
</section><section>
<h2 id="continuous-integration-software">Continuous integration software</h2>
<p>Software that promotes CI practices should:</p>
<ul>
<li>Provide <em>clean environments</em> for compilation/testing</li>
<li>Provide a <em>wide range</em> of environments
<ul>
<li>Matching the relevant specifications of the actual targets</li>
</ul>
</li>
<li>High degree of <em>configurability</em></li>
<li>Possibly, <em>declarative configuration</em></li>
<li>A <em>notification system</em> to alert about failures or issues</li>
<li>Support for <em>authentication</em> and deployment to external services</li>
</ul>
<p><strong>Plenty</strong> of integrators on the market</p>
<ul>
<li>GitHub Actions, Circle CI, Travis CI, Werker, done.io, Codefresh, Codeship, Bitbucket Pipelines&hellip;</li>
</ul>
</section><section>
<h1 id="core-concepts">Core concepts</h1>
<p>Naming and organization is variable across platforms, but <em>in general</em>:</p>
<ul>
<li>One or more <strong>pipelines</strong> can be associated to <strong>events</strong>
<ul>
<li>For instance, a <em>new commit</em>, an update to a <em>pull request</em>, or a <em>timeout</em></li>
</ul>
</li>
<li>Every pipeline is composed of a <strong>sequence</strong> of <strong>operations</strong> (<em>jobs</em>, <em>stages</em>, <em>phases</em>)</li>
<li>Every <strong>operation</strong> could be composed of sequential or parallel <strong>sub-operations</strong> (<em>jobs</em>, <em>phases</em>, <em>steps</em>)</li>
<li>How many hierarchical levels are available depends on the specific platform
<ul>
<li>GitHub Actions: <em>workflow</em> $\Rightarrow$ <em>job</em> $\Rightarrow$ <em>step</em></li>
<li>Travis CI: <em>build</em> $\Rightarrow$ <em>stage</em> $\Rightarrow$ <em>job</em>  $\Rightarrow$ <em>phase</em></li>
</ul>
</li>
<li>Execution happens in a <strong>fresh system</strong> (virtual machine or container)
<ul>
<li>Often containers inside virtual machines</li>
<li>The specific point of the hierarchy at which the VM/container is spawned depends on the CI platform</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="ci-in-github-actions">CI in GitHub Actions</h2>
<ul>
<li>Very <em>open-source friendly</em></li>
<li>Integrated in GitHub</li>
<li><em>Less mature</em> than other integrators
<ul>
<li>My personal feeling is that it was built <em>bottom-up</em>&hellip;</li>
</ul>
</li>
<li>Some questionable limitations</li>
<li>A lot of parallelism (20 concurrent jobs, 5 for MacOS X)</li>
</ul>
</section><section>
<h2 id="ci-in-github-actions-1">CI in GitHub Actions</h2>
<p><strong>step</strong></p>
<ul>
<li>A (<em>possibly named</em>) <em>command</em> or <em>sequence of commands</em></li>
<li>Can be executed on the virtual machine or inside a container</li>
<li>Defines <em>success</em> or <em>failure</em>
<ul>
<li>Usually, the return value of the last command</li>
</ul>
</li>
</ul>
<p><strong>action</strong></p>
<ul>
<li>A <em>reusable step</em>
<ul>
<li>DRY in CI $\Rightarrow$ Laboratory of Software Systems</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="ci-in-github-actions-2">CI in GitHub Actions</h2>
<p><strong>job</strong></p>
<ul>
<li>A <em>sequence of steps</em> that run in parallel</li>
<li>Executed on a <em>virtual machine</em></li>
<li>A job is <em>successful</em> if all its steps are successful</li>
<li>Multiple jobs can be spawned at once via <em>matrix expansion</em>
<ul>
<li>e.g., spawn one job for each OS and version of the JVM</li>
<li>CI Matrix expansion $\Rightarrow$ Laboratory of Software Systems</li>
</ul>
</li>
</ul>
<p><strong>workflow</strong></p>
<ul>
<li>A <em>named sequence of steps</em></li>
<li>There can be multiple workflows per repository</li>
<li>Workflows are <em>isolated</em></li>
</ul>
</section><section>
<h2 id="github-actions-configuration">GitHub Actions: Configuration</h2>
<p>Workflows are configured in the <code>.github/workflows/</code> folder of the repository</p>
<ul>
<li>One <strong>YAML</strong> file per <em>workflow</em></li>
<li>GHA YAML is (sic) <em>non-standard</em>
<ul>
<li>DRY is limited: <em><strong>no</strong> anchors</em>, <em><strong>no</strong> merge keys</em></li>
</ul>
</li>
<li>In the following, I assume you know YAML
<ul>
<li>You can <a href="https://learnxinyminutes.com/docs/yaml/">learn it in minutes</a></li>
<li>Just remember that anchors and merge keys are not supported</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="github-actions-triggering-event">GitHub Actions: Triggering event</h2>
<p>Workflows <em>react</em> to <a href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows">events</a></p>
<ul>
<li>Events that trigger a workflow are specified under the <code>on</code> key</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#b06;font-weight:bold">on</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#b06;font-weight:bold">push</span>:<span style="color:#bbb"> </span><span style="color:#888"># Trigger the workflow on push</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#b06;font-weight:bold">branches</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- main<span style="color:#bbb"> </span><span style="color:#888"># but only for the main branch</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#b06;font-weight:bold">pull_request</span>:<span style="color:#bbb"> </span><span style="color:#888"># Also trigger for pull requests</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#b06;font-weight:bold">branches</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- main<span style="color:#bbb"> </span><span style="color:#888"># but only for the main branch</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#b06;font-weight:bold">page_build</span>:<span style="color:#bbb"> </span><span style="color:#888"># Also trigger on page_build</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#b06;font-weight:bold">release</span>:<span style="color:#bbb"> </span><span style="color:#888"># Also trigger on release...</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#b06;font-weight:bold">types</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- created<span style="color:#bbb"> </span><span style="color:#888"># ...created</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#b06;font-weight:bold">schedule</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#b06;font-weight:bold">cron</span>:<span style="color:#bbb">  </span><span style="color:#d20;background-color:#fff0f0">&#39;*/30 5,17 * * *&#39;</span><span style="color:#bbb"> </span><span style="color:#888"># Cron syntax (see crontab.guru)</span><span style="color:#bbb">
</span></code></pre></div></section><section>
<h2 id="github-actions-environment-preparation">GitHub Actions: Environment preparation</h2>
<p>GitHub actions job run on a <em>fresh virtual machine</em></p>
<ul>
<li>The <em>operating system</em> can be selected (Windows, Ubuntu, MacOS X)
<ul>
<li>Multi OS builds $\Rightarrow$ Laboratory of Software Systems</li>
</ul>
</li>
<li>The repository needs to be <em>cloned manually</em></li>
<li>Any operation should be <em>configured manually</em></li>
</ul>
<p>Rather than <em>convention over configuration</em>, GHA use <strong>actions</strong> as a form of configuration reuse</p>
<ul>
<li>Actions can be found on the <a href="https://github.com/marketplace?type=actions">GH marketplace</a></li>
<li>Developing new actions $\Rightarrow$ Laboratory of Software Systems</li>
</ul>
</section><section>
<h2 id="github-actions-a-simple-gradle-build">GitHub Actions: a simple gradle build</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="nohighlight" data-noescape><span style="color:#b06;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Clone Repository<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#b06;font-weight:bold">on</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#b06;font-weight:bold">push</span>:<span style="color:#bbb"> </span><span style="color:#888"># On every push on any branch</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#b06;font-weight:bold">jobs</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#b06;font-weight:bold">Build</span>:<span style="color:#bbb"> </span><span style="color:#888"># Job name</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#b06;font-weight:bold">runs-on</span>:<span style="color:#bbb"> </span>ubuntu-latest<span style="color:#bbb"> </span><span style="color:#888"># Operating system selection</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#b06;font-weight:bold">env</span>:<span style="color:#bbb"> </span><span style="color:#888"># Environment can be controlled at the job or step level</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#b06;font-weight:bold">TERM</span>:<span style="color:#bbb"> </span>dumb<span style="color:#bbb"> </span><span style="color:#888"># Sets the environment variable TERM to &#34;dumb&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#b06;font-weight:bold">steps</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#b06;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Checkout<span style="color:#bbb"> </span><span style="color:#888"># custom name Checkout the repository</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#b06;font-weight:bold">uses</span>:<span style="color:#bbb"> </span>actions/checkout@v2<span style="color:#bbb"> </span><span style="color:#888"># Action implemented in this repository, tag &#34;2&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#b06;font-weight:bold">uses</span>:<span style="color:#bbb"> </span>joschi/setup-jdk@v2.3.0<span style="color:#bbb"> </span><span style="color:#888"># Action implemented in repository &#34;joschi/setup-jdk&#34; tag &#34;2.3.0&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#b06;font-weight:bold">with</span>:<span style="color:#bbb"> </span><span style="color:#888"># Actions parameters (action name omitted)</span><span style="color:#bbb">
</span><span style="color:#bbb">          </span><span style="color:#b06;font-weight:bold">java-version</span>:<span style="color:#bbb"> </span><span style="color:#00d;font-weight:bold">15</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>- <span style="color:#b06;font-weight:bold">name</span>:<span style="color:#bbb"> </span>Build<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#b06;font-weight:bold">run</span>:<span style="color:#bbb"> </span>./gradlew check<span style="color:#bbb">
</span></code></pre></div></section><section>
<h1 id="automated-delivery">Automated delivery</h1>
<p>Once the <em>reference environment</em> in CI completed the software construction and testing,
it should <strong>sign</strong> and then <strong>deliver</strong> the result.</p>
<ul>
<li>Possibly, even <strong>deploy</strong> the result, putting it at work</li>
</ul>
<h3 id="some-delivery-targets">Some delivery targets</h3>
<ul>
<li><a href="https://docs.github.com/en/github/administering-a-repository/about-releases">GitHub releases</a>
<ul>
<li>Retract, language agnostic, good for releases</li>
</ul>
</li>
<li><a href="https://search.maven.org/">Sonatype OSSRH (a.k.a. <em>Maven Central</em>)</a>
<ul>
<li>De-facto standard for JVM products, no retract policy</li>
</ul>
</li>
<li><a href="https://github.com/features/packages">GitHub packages</a>
<ul>
<li>No retract, authentication required also in read mode, immature</li>
</ul>
</li>
<li><del>JFrog Bintray</del> <a href="https://jfrog.com/blog/into-the-sunset-bintray-jcenter-gocenter-and-chartcenter/">✝ 2021-05-01</a>
<ul>
<li>Maven Central + other stuff</li>
</ul>
</li>
</ul>
<p>In <a href="https://github.com/AlchemistSimulator/Alchemist/tree/3535e1b42097c86c6d5d3662fff554558381e5fc">this repository</a>,
delivery is enabled towards all the aforementioned destinations</p>
</section><section>
<h1 id="no-retract">No-retract</h1>
<p>Your error will remain in the repositories <em>forever</em> and you will <em>never</em> be able to
fix it, you will need to <em>create a new release</em> with a <em>different version number</em>.</p>
<p><strong>Anectodal apology of no-retract policies</strong></p>
<p>In March 2016, Azer Koçlu unpublished more than 250 of his modules
from NPM, which is a popular package manager used by Javascript
projects to install dependencies, because he was asked to rename the
module <code>Kik</code>, whose name is the same of an instant messaging app that
wanted to publish a homonym module.
Unfortunately, one of those dependencies was <code>left-pad</code>, a <em>11-line-long</em>
Javascript module, used by <em>thousands</em> of projects. This brought
breackages throughout many Javascript products (most notably Node and
Babel). NPM had to un-unpublish <code>left-pad</code>.</p>
</section><section>
<h2 id="picking-version-numbers">Picking version numbers</h2>
<blockquote>
<p>Without compliance to some sort of formal specification, version
numbers are essentially useless for dependency management. By
giving a name and clear definition to the above ideas, it becomes
easy to communicate your intentions to the users of your software.</p>
</blockquote>
<h3 id="semantic-versioninghttpsemverorg"><a href="http://semver.org/">Semantic versioning</a></h3>
<ul>
<li>Formally described, RFC-style</li>
<li>Three levels plus optional: <code>MAJOR.MINOR.PATCH[-OTHER][+BUILD]</code>
<ul>
<li><code>MAJOR</code> — Any incompatible API change
<ul>
<li>Major <code>0</code> is for initial development: anything may change at any time.</li>
</ul>
</li>
<li><code>MINOR</code> — Add functionality in a backwards-compatible manner</li>
<li><code>PATCH</code> — Backwards-compatible bug fixes</li>
<li><code>OTHER</code> — Optionally decorates the version with additional information.</li>
<li><code>BUILD</code> — Optionally decorates the version with build information.</li>
</ul>
</li>
<li>First release: <code>0.1.0</code>, <code>1.0.0</code> formalizes the API</li>
</ul>
</section>

  


</div>
      

    </div>
<script type="text/javascript" src=/Course-Laboratory-of-Software-Systems/reveal-hugo/object-assign.js></script>

<a href="/Course-Laboratory-of-Software-Systems/reveal-js/css/print/" id="print-location" style="display: none;"></a>
<script type="text/javascript">
  var printLocationElement = document.getElementById('print-location');
  var link = document.createElement('link');
  link.rel = 'stylesheet';
  link.type = 'text/css';
  link.href = printLocationElement.href + (window.location.search.match(/print-pdf/gi) ? 'pdf.css' : 'paper.css');
  document.getElementsByTagName('head')[0].appendChild(link);
</script>

<script type="application/json" id="reveal-hugo-site-params">{"height":"100%","pdfseparatefragments":false,"theme":"white","width":"100%"}</script>
<script type="application/json" id="reveal-hugo-page-params">{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"custom_theme_options":{"enablesourcemap":true,"targetpath":"css/custom-theme.css"},"transition":"slide","transition_speed":"fast"}</script>

<script src="/Course-Laboratory-of-Software-Systems/reveal-js/js/reveal.js"></script>

<script type="text/javascript">
  
  
  function camelize(map) {
    if (map) {
      Object.keys(map).forEach(function(k) {
        newK = k.replace(/(\_\w)/g, function(m) { return m[1].toUpperCase() });
        if (newK != k) {
          map[newK] = map[k];
          delete map[k];
        }
      });
    }
    return map;
  }
  
  var revealHugoDefaults = { center: true, controls: true, history: true, progress: true, transition: "slide" };
  var revealHugoSiteParams = JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);
  var revealHugoPageParams = JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);
  
  var options = Object.assign({},
    camelize(revealHugoDefaults),
    camelize(revealHugoSiteParams),
    camelize(revealHugoPageParams));
  Reveal.initialize(options);
</script>


  
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/markdown/marked.js"></script>
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/markdown/markdown.js"></script>
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/highlight/highlight.js"></script>
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/zoom-js/zoom.js"></script>
  
  
  <script type="text/javascript" src="/Course-Laboratory-of-Software-Systems/reveal-js/plugin/notes/notes.js"></script>



    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>

<script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

    
  </body>
</html>
